<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Pledge To Vote | Every Vote Counts</title>

    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Serif:400,700|Poppins:400,700" rel="stylesheet">
    <link href="./style.css" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
    <script src="./script.js"></script>
  </head>
  <body>
    <div class="nav">
      <div class="hero nav-section">
        <a href="/">
          <img src="./img/EVC.PNG" alt="Every Vote Counts">
        </a>
      </div>
      <div class="nav-list nav-section">
        <ul>
          <li class="nav-item ptv">
            <a href="/">Pledge To Vote</a>
          </li>
          <li class="nav-item about">
            <a href="/">About Us</a>
          </li>
        </ul>
      </div>
    </div>
    <div class="content container-fluid">
      <div class="col-xs-12 col-md-6 panel l-panel">
        <!-- Left Panel -->
        <div class="panel-wrapper">
          <!-- Logo -->
          <div class="logo">
            <img src="./img/EVC.PNG" alt="Every Vote Counts">
          </div>
          <!-- Title -->
          <div class="title">
            <h1>I Pledge to Vote in 2018 </h1>
          </div>
          <!-- Divider -->
          <span class="divider"></span>
          <!-- Subtitle -->
          <div class="subtitle">
            <p>
              <span class="hidden-mob">
                November 2018 will be <span class="bold">critical</span> for our democracy. It is a chance for each of us to express our views and exercise our civic duty in elections across the United States.
                <br>
                <br>
              </span>
              Commit to vote in November, and between now and then, we will make sure you have everything you need to <span class="bold">get registered</span> and <span class="bold">take action</span> in your community.
            </p>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-md-6 panel r-panel">
        <!-- Right Panel -->
        <div class="panel-wrapper">
          <div class="vote-form-wrapper">
            <div id="pledge-form" class="vote-form">
              <div class="input-wrap">
                <input id="fname" class="half-input" type="text" name="fname" placeholder="First Name">
                <input id="lname" class="half-input" type="text" name="lname" placeholder="Last Name">
              </div>
              <div class="input-wrap">
                <input id="email" class="full-input" type="text" name="email" placeholder="Email Address">
              </div>
              <div class="input-wrap">
                <input id="phone" class="full-input" type="tel" name="phone" placeholder="Phone Number (Optional)">
              </div>
              <div class="btn-wrap">
                <button id="submit-btn" class="button">Commit To Vote &rarr;</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script
      src="https://code.jquery.com/jquery-2.2.4.min.js"
      integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
      crossorigin="anonymous"></script>
    <script src='./ext/jquery-serialize.js'></script>
    <script>
      var $form = $('#pledge-form'),
      url = 'https://script.google.com/macros/s/AKfycbwC7rrSfKt9ntAYyLL4qm7tVdXf6xknIkdQzPa6uqcVNKEBvdK6/exec'

      $('#pledge-form button').on('click', function(e) {
        e.preventDefault();

        if (!$(this).hasClass('disabled')) {
          $(this).addClass('disabled');

          var fname = $('#pledge-form #fname').val(),
          lname = $('#pledge-form #fname').val(),
          email = $('#pledge-form #email').val(),
          phone = $('#pledge-form #phone').val();

          if (validateForm(fname, lname, email)) {
            var jqxhr = $.ajax({
              url: url,
              method: "GET",
              dataType: "json",
              data: $form.serializeObject()
            }).success(function() {
              alert('Thanks for pledging to vote! We will be in touch shortly with more information!');
              $('#pledge-form button').text('Thanks for pledging!');
            }
            );
          } else {
            $(this).removeClass('disabled');
          }
        }
      })

      function validateForm(fname, lname, email) {
        console.log(fname, lname, email);

        if (!fname || fname.length == 0 || fname == '') {
          alert('First name is required');
          $('#pledge-form #fname').addClass('err');
          return false;
        } else {
          console.log('fname checks')
        }

        if (!lname || lname.length == 0 || lname == '') {
          alert('Last name is required');
          $('#pledge-form #lname').addClass('err');
          return false;
        } else {
          console.log('lname checks')
        }

        if (!email || email.length == 0) {
          alert('Valid email is required');
          $('#pledge-form #email').addClass('err');
          return false;
        } else {
          console.log('email checks')
        }

        return true;
      }
    </script>
  </body>
</html>
